" --- Basic UX ---
set nocompatible
filetype plugin indent on
syntax on
set number
set hidden
set updatetime=300
set clipboard=unnamedplus
set mouse=a

" Leader
let mapleader="\\"
set runtimepath^=~/.vim
set runtimepath+=~/.vim/after
let &packpath = &runtimepath


" --- vim-ollama settings ---
" The plugin expects Ollama API reachable at http://ollama:11434 by default in this compose setup.
" If you change compose service name or port, update this.
let g:ollama_host = get(environ(), 'OLLAMA_BASE_URL', 'http://ollama:11434')

" Keymaps (adjust to your taste)
" Completion / suggestions (depends on plugin features)
nnoremap <leader>oc :OllamaComplete<CR>
vnoremap <leader>or :OllamaRewrite<CR>

" FZF shortcuts
nnoremap <leader>ff :Files<CR>
nnoremap <leader>fg :Rg<CR>

" --- Notes ---
" If you want to prevent accidental data exfiltration, keep mounts limited to ./persist/workspace.


" >>> ai-sandbox seed BEGIN
" Ensure ~/.vim is on runtimepath (bind-mount safe)
set runtimepath^=~/.vim
set runtimepath+=~/.vim/after
let &packpath = &runtimepath

" If your vimrc already defines mapleader, keep yours; otherwise set it here.
if !exists("mapleader")
  let mapleader="\\"
endif

" vim-plug bootstrap (expects ~/.vim/autoload/plug.vim)
" Add this part to ensure that plug is loaded prior to checking with `exists`
try
    call plug#nosuchfunction()
catch /.*/
endtry
if exists('*plug#begin')
  " If you already have a plugin section elsewhere, you may remove the plugins below
  " and keep only the PlugInstall step in this script.
  call plug#begin('~/.vim/plugged')

  " Minimal plugins (example)
  Plug 'gergap/vim-ollama'
  Plug 'tpope/vim-surround'
  Plug 'tpope/vim-commentary'
  Plug 'junegunn/fzf', { 'do': { -> fzf#install() } }
  Plug 'junegunn/fzf.vim'

  call plug#end()
endif
if !isdirectory($HOME . "/.vim/plugged")
  echo "Directory does not exist, installing plugins for the first (and only) time"
  PlugInstall
endif
" <<< ai-sandbox seed END
